<html>
<head>
    <meta charset="utf-8">
</head>
<body>

<form id='uploadform' action="" method="post" enctype="multipart/form-data" target="result_iframe" >
<input type="file" name="file" id="file"><br>
<input type="hidden" name="key" value="3.14159265">
<input type="submit" name="submit" value="Upload The File">
</form>
<p id='progress'></p>
<iframe id='result_iframe'></iframe>

<script>
	var fileid = 'id-'+Math.random();
	uploadform.action = 'post.jssp?session_upload_progress_prefix='+fileid;
	progress.innerHTML = 'begin';

	setInterval(function()
	{
		http = new XMLHttpRequest();
		var id = 'session_upload_progress_prefix'+fileid;
		http.open('GET','postfileprogress.jssp?id='+id,true);
		http.onreadystatechange = function()
		{
			if(4==http.readyState) progress.innerHTML = http.responseText;
		};
  		http.send(null);
	},2000);
</script>
</body>
</html>